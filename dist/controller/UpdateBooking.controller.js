sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","sap/m/library","sap/m/MessageBox"],function(e,t,o,n){"use strict";var i;var s;return e.extend("zsd031hoteldetail.controller.UpdateBooking",{onInit:function(){var e=this.getOwnerComponent().getRouter();e.getRoute("UpdateBooking").attachMatched(function(e){this._selectItemWithId(e.getParameter("arguments").bookingId)},this)},_selectItemWithId:function(e){var o=this.getOwnerComponent().getModel();var n=this.getView();o.read("/bookingSet("+e+")",{success:function(e,o){const a=new t;a.setProperty("/toUpdateBooking",e);i=e.HotelId;s=e.Startdate;n.setModel(a);console.log(e.Startdate)},error:function(e){console.log(e)}})},onUpdatePressed:function(){const e=sap.ui.core.format.DateFormat.getDateTimeInstance({pattern:"dd/MM/yyyy"});let t=true;let o=this.getView().getModel().getProperty("/toUpdateBooking");let i=""+o.Startdate;console.log(o.Startdate);if(o.Startdate!=s){try{let t=i.split(".");let n=t[0]+"-"+t[1]+"-"+t[2];o.Startdate=e.parse(n+"T05:00:00");console.log(o.Startdate)}catch(e){t=false}}o.Nights=parseInt(o.Nights);if(!t||o.Startdate==null){console.log("no valid date");n.show("Use the date picker to choose a valid date.",{icon:n.Icon.INFORMATION,title:"Use the date picker",actions:[n.Action.OK],onClose:function(e){/ * do something * /}})}else if(o.Startdate<=new Date){n.show("The date that you'll arrive, can only be in the future.",{icon:n.Icon.INFORMATION,title:"Date can only be in the future.",actions:[n.Action.OK],onClose:function(e){/ * do something * /}})}else if(isNaN(o.Nights||o.Nights==0)){n.show("Fill in a number other than 0 in the field Nights.",{icon:n.Icon.INFORMATION,title:"Fill in a number",actions:[n.Action.OK],onClose:function(e){/ * do something * /}})}else{this.getOwnerComponent().getModel().update("/bookingSet("+o.Id+")",o,{merge:true,success:function(){console.log("succes")},error:function(e){console.log(e)}});console.log(o.HotelId);this.navToDetail()}},onDeletePressed:function(){let e=this.getView().getModel().getProperty("/toUpdateBooking");this.getOwnerComponent().getModel().remove("/bookingSet("+e.Id+")",{success:function(){console.log("Booking is deleted.")},error:function(e){console.log(e)}});this.navToDetail()},navToDetail:function(){this.getRouter().navTo("Detail",{hotelId:i})}})});